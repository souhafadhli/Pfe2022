var splitTextArr=[];var groupArr=[];var tlMap=new Map();var splitTextMap=new Map();function initAnimation(svg){var id=svg.getAttribute('id');var tl=tlMap.get(id);var isLoadAnimation=svg.getAttribute('data-loaded');if(isLoadAnimation==null||isLoadAnimation=="false"){tl=gsap.timeline();id='_'+Math.random().toString(36).substr(2,9);tlMap.set(id,tl);svg.setAttribute('id',id);var animationAttr=svg.getAttribute('animation');if(animationAttr!=null){var json=JSON.parse(animationAttr);var jsonSripts=json['scriptArr'];loadAnimation(jsonSripts,id,svg);tl.pause();svg.setAttribute('data-loaded',true);}}}
function animate(svg){var id=svg.getAttribute('id');var tl=tlMap.get(id);if(tl!=null){tl.restart();}}
function endAnimation(svg){var id=svg.getAttribute('id');var tl=tlMap.get(id);if(tl!=null){tl.pause();tl.seek(0);}}
function preStartAnimation(svg){var id=svg.getAttribute('id');var tl=tlMap.get(id);var words,lines,chars;var animationAttr=svg.getAttribute('animation');if(animationAttr!=null){var json=JSON.parse(animationAttr);var scriptJsons=json['scriptArr'];if(scriptJsons!=null&&scriptJsons.length!=0){scriptJsons.forEach(scriptJson=>{var countAnimation=0;var isText=scriptJson['isText'];var className=scriptJson['className'];var animations=scriptJson['animations'];var isExit=false;var animationNum=0;var mySplitText,script;if(animations!=null){animations.forEach(animation=>{animationNum+=1;var isRepeat,repeatDuration,isInfinity;script=animation['script'];var startTime=animation['startTime'];var duration=animation['duration'];var options=animation['options'];if(options!=null){Object.keys(options).forEach(key=>{var option=options[key];var optionItems=option['optionItem'];if(optionItems!=null){Object.keys(optionItems).forEach(subKey=>{var item=optionItems[subKey];if(item['selectedOption']){isRepeat=item['isRepeat'];repeatDuration=item['repeatTimes'];isInfinity=item['infinityRepeat'];}});}});}
if(startTime==null){startTime=">";}
if(script!=null){if(animation['isEnterAnimation']==0){countAnimation+=1;}
var cellId=scriptJson['cellId'];if(isText){var items=svg.querySelectorAll('[cell-id=\"'+cellId+'\"]');items.forEach(node=>{if(node.tagName=="foreignObject"){var loopTextChild=function(node){var children=node.children;if(children!=null&&children.length>0){if(children.length==1){var child=children[0];node=loopTextChild(child);}}
if(node.tagName.toLowerCase()=="br"){node=node.parentNode;}
return node;}
var setTextAnimation=function(textNode){mySplitText=new SplitText(textNode,{type:"chars,words,lines"});chars=mySplitText.chars;words=mySplitText.words;lines=mySplitText.lines;splitTextMap.set(cellId,mySplitText);splitTextArr.push(mySplitText);script=script.replace("this.",'');if(animationNum!=1){if(countAnimation>=1){if(animation['isEnterAnimation']==0){var immediateString=",immediateRender:false";var scriptX=script.lastIndexOf("}");script=script.substring(0,scriptX)+immediateString+script.substring(scriptX,script.length);}}}
if(isExit){isExit=false;tl.add(gsap.set(chars,{x:0,y:0,opacity:1,scale:1,rotation:0}),startTime);tl.add(gsap.set(words,{x:0,y:0,opacity:1,scale:1,rotation:0}),startTime);tl.add(gsap.set(lines,{x:0,y:0,opacity:1,scale:1,rotation:0}),startTime);}
if(animation['isEnterAnimation']==1){isExit=true;}
var a=eval(script);if(isRepeat!=true){a.totalDuration(duration);tl.add(a,startTime);}else{if(!isInfinity){var subTlduration=repeatDuration;var subTl=gsap.timeline();subTl.add(a);subTl.pause();tl.add(subTl.tweenTo(subTlduration),startTime);}else{tl.add(a,startTime);}}}
node=loopTextChild(node);if(node.children!=null&&node>1){var children=node.children;var isBr=false;children.forEach(child=>{if(node.tagName.toLowerCase()=="br"){isBr=true;}else{gsap.set(child,{opacity:1});setTextAnimation(child);}});if(isBr){gsap.set(node,{opacity:1});setTextAnimation(node);}}else{gsap.set(node,{opacity:1});setTextAnimation(node)}}});}}});}});}
if(tl!=null){tl.pause();tl.seek(0);}}}
function loadAnimation(scriptJsons,id,svg){var tl=tlMap.get(id);var words,lines,chars;if(scriptJsons!=null&&scriptJsons.length!=0){scriptJsons.forEach(scriptJson=>{var countAnimation=0;var isGroup=scriptJson['isGroup'];var isText=scriptJson['isText'];var className=scriptJson['className'];var animations=scriptJson['animations'];var isExit=false;var animationNum=0;var mySplitText,script;if(animations!=null){if(isGroup){var group;var isCreatedGroup=false;var groupArr=[];var groupedCellId=scriptJson['groupCellIdArr'];if(groupedCellId!=null){if(groupArr.length!=0){groupArr.forEach(g=>{if(g.classList.contains(className)){isCreatedGroup=true;group=g;}});}
if(isCreatedGroup==false){group=document.createElementNS("http://www.w3.org/2000/svg",'g');group.setAttribute('class',className);svg.appendChild(group);groupedCellId.forEach(id=>{var items=svg.querySelectorAll('[cell-id=\"'+id+'\"]');items.forEach(node=>{if(node.tagName!="mask"&&node.parentNode.tagName!="mask"&&node.tagName!="clipPath"&&node.parentNode.tagName!="clipPath"){group.appendChild(node);}});});groupArr.push(group);}
animations.forEach(animation=>{animationNum+=1;var isRepeat,repeatDuration,isInfinity;script=animation['script'];var startTime=animation['startTime'];var duration=animation['duration'];var options=animations['options'];if(options!=null){Object.keys(options).forEach(key=>{var option=options[key];var optionItems=option['optionItem'];if(optionItems!=null){Object.keys(optionItems).forEach(subKey=>{var item=optionItems[subKey];if(item['selectedOption']){isRepeat=item['isRepeat'];repeatDuration=item['repeatTimes'];isInfinity=item['infinityRepeat'];}});}});}
if(startTime==null){startTime=">";}
if(animation['isEnterAnimation']==0){countAnimation+=1;}
if(script!=null){if(animationNum!=1){if(countAnimation>=1){if(animation['isEnterAnimation']==0){var immediateString=",immediateRender:false";var scriptX=script.lastIndexOf("}");script=script.substring(0,scriptX)+immediateString+script.substring(scriptX,script.length);}}}
script=script.replace("'."+className+"'",'group');if(isExit){isExit=false;tl.add(gsap.set(group,{x:0,y:0,opacity:1,scale:1,rotation:0}),startTime);}
if(animation['isEnterAnimation']==1){isExit=true;}
var a=eval(script);if(duration!=null&&!isRepeat){a.totalDuration(duration);}
if(isRepeat!=true){tl.add(a,startTime);}else{if(!isInfinity){var subTlduration=repeatDuration;var subTl=gsap.timeline();subTl.add(a);subTl.pause();tl.add(subTl.tweenTo(subTlduration),startTime);}else{tl.add(a,startTime);}}}});}}else{animations.forEach(animation=>{animationNum+=1;var isRepeat,repeatDuration,isInfinity;script=animation['script'];var startTime=animation['startTime'];var duration=animation['duration'];var options=animation['options'];if(options!=null){Object.keys(options).forEach(key=>{var option=options[key];var optionItems=option['optionItem'];if(optionItems!=null){Object.keys(optionItems).forEach(subKey=>{var item=optionItems[subKey];if(item['selectedOption']){isRepeat=item['isRepeat'];repeatDuration=item['repeatTimes'];isInfinity=item['infinityRepeat'];}});}});}
if(startTime==null){startTime=">";}
if(script!=null){if(animation['isEnterAnimation']==0){countAnimation+=1;}
var cellId=scriptJson['cellId'];if(isText){var items=svg.querySelectorAll('[cell-id=\"'+cellId+'\"]');items.forEach(node=>{if(node.tagName=="foreignObject"){var loopTextChild=function(node){var children=node.children;if(children!=null&&children.length>0){if(children.length==1){var child=children[0];node=loopTextChild(child);}}
if(node.tagName.toLowerCase()=="br"){node=node.parentNode;}
return node;}
node=loopTextChild(node);if(node.children!=null&&node>1){var children=node.children;var isBr=false;children.forEach(child=>{if(node.tagName.toLowerCase()=="br"){isBr=true;}else{gsap.set(child,{opacity:0});}});if(isBr){gsap.set(node,{opacity:0});}}else{gsap.set(node,{opacity:0});}}});}else{if(cellId!=null){var items=svg.querySelectorAll('[cell-id=\"'+cellId+'\"]');if(animationNum!=1){if(countAnimation>=1){if(animation['isEnterAnimation']==0){var immediateString=",immediateRender:false";var scriptX=script.lastIndexOf("}");script=script.substring(0,scriptX)+immediateString+script.substring(scriptX,script.length);}}}
items.forEach(node=>{if(node.tagName!="mask"&&node.parentNode.tagName!="mask"&&node.tagName!="clipPath"&&node.parentNode.tagName!="clipPath"){script=script.replace("'."+className+"'",'node');if(isExit){isExit=false;tl.add(gsap.set(node,{x:0,y:0,opacity:1,scale:1,rotation:0}),startTime);}
if(animation['isEnterAnimation']==1){isExit=true;}
var a=eval(script);if(duration!=null&&!isRepeat){a.totalDuration(duration);}
if(isRepeat!=true){tl.add(a,startTime);}else{if(!isInfinity){var subTlduration=repeatDuration;var subTl=gsap.timeline();subTl.add(a);subTl.pause();tl.add(subTl.tweenTo(subTlduration),startTime);}else{tl.add(a,startTime);}}}});}}
tlMap.set(id,tl);}});}}});}}
function replaceAll(str,find,replace){return str.replace(new RegExp(find,'g'),replace);}